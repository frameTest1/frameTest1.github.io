
<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/amazon-connect-streams/release/connect-streams-min.js"></script>
    <style>
        /* Adjust styles as needed for ServiceNow */
        #ccp-container {
            width: 100%;
            height: 800px;
            border: 1px solid #ccc; /* Optional styling */
        }
        #wisdom-container {
            width: 100%;
            height: 600px; /* Adjust height as needed */
        }
    </style>
</head>
<body>
    <div id="ccp-container"></div>
    <div id="wisdom-container"></div>
    <div id="customviews-container" style="display:none;"></div>

    <script type="text/javascript">
        window.onload = function () {
            const rootLogger = connect.getLog();
            rootLogger.setLogLevel(connect.LogLevel.DEBUG);
            rootLogger.setEchoLevel(connect.LogLevel.DEBUG);

            rootLogger.debug("CDEBUG >> Page loaded");

            const connectUrl = " https://servicenow--instance.my.connect.aws";
            const connectRegion = "us-east-1";
            const ccpUrl = connectUrl + "/ccp";

            try {
                rootLogger.debug("CDEBUG >> Initializing CCP");

                connect.core.initCCP(document.getElementById("ccp-container"), {
                    ccpUrl: ccpUrl,
                    loginPopup: true,
                    loginPopupAutoClose: true,
                    region: connectRegion,
                    softphone: {
                        allowFramedSoftphone: true,
                        disableRingtone: false,
                        allowFramedVideoCall: true,
                        allowEarlyGum: true
                    },
                    pageOptions: {
                        enableAudioDeviceSettings: true,
                        enablePhoneTypeSettings: true
                    },
                    ccpAckTimeout: 5000,
                    ccpSynTimeout: 3000,
                    ccpLoadTimeout: 10000
                });

                rootLogger.info("CDEBUG >> CCP initialized");

                // Initialize Amazon Q (Wisdom)
                connect.agentApp.initApp(
                    "wisdom",
                    "wisdom-container",
                    connectUrl + "/wisdom-v2/",
                    { style: "width:100%; height:100%;" }
                );
                rootLogger.info("CDEBUG >> Wisdom (Amazon Q) initialized");

                // Subscribe to contact view event
                connect.core.onViewContact(function (event) {
                    rootLogger.debug("CDEBUG >> Viewing contact ID: " + event.contactId);
                });

            } catch (error) {
                console.error("CDEBUG >> Error during initialization:", error);
                rootLogger.error("CDEBUG >> Error during initialization: " + error.message);
            }
        };
    </script>
</body>
</html>
